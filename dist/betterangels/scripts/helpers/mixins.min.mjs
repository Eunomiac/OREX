import{gsap as t,Dragger as s,InertiaPlugin as e,MotionPathPlugin as r,U as i,XElem as n,XCircle as h,XItem as o,XDie as a,XSnap as p}from"./bundler.mjs";class u{constructor(t){this.t=t}i(...t){return t.reduce(((t,s=(t=>t))=>s(t)),this.t)}}export const MIX=(t=class{})=>new u(t);export const HasMotionPath=s=>class extends s{get path(){return this.h}set path(s){t.set(s,{o:-50,p:-50,transformOrigin:"50% 50%"}),$(s).attr("id",`${this.id}-motion-path`),this.h={id:`${this.id}-motion-path`,u:s,raw:r.g(s),l:i.P(i.m($(s).attr("d"),/(\d+)\s*z$/giu))},r.S(this.path.raw)}constructor(s,{path:e,D:r={},...n}={}){super(s,n);const[h]=this._.find(".motion-path");t.set(h,i.T({...this.constructor.O.C,...r},(t=>null!==t))),this.path=h}I(t){const{x:s,y:e,angle:i}=r.M(this.path.raw,t,!0);return{x:s,y:e,angle:i,$:t}}N(s,{$:e,x:r,y:n}={}){return e=e??t.U.normalize(0,360,i.A(this.H(s,{x:r??s.x,y:n??s.y}),[0,360])),this.I(e)}};export const HasSnapPath=s=>class extends(HasMotionPath(s)){get path(){const s=this;return{...super.path,get points(){return[...Array(s.k)].map(((e,r)=>{const i=s.I(t.U.v(0,s.k,0,1,r));return s.R(n.W,i)}))}}}set path(t){super.path=t,this.constructor.j=this}static get j(){return this.X=this.X??new Map}static set j(t){t.path.points.forEach((({x:s,y:e})=>{s=i.P(s),e=i.P(e),this.j.set({x:s,y:e},t)}))}static q(t){this.j.forEach(((s,e,r)=>{t.id===s.id&&r.delete(e)})),super.q(t)}get k(){return this.B=this.B??10}set k(t){this.B=t}};export const IsDraggable=t=>class extends t{get F(){return this.G}get J(){return this.F?.J}get K(){return this.L&&!this.J}get V(){return super.V||this.K||this.J}set V(t){super.V=t}get parent(){return super.parent}set parent(t){super.parent=t,this.F?.update()}constructor(t,s={}){super(t,s),this.Y()}Y(){const t=this;[this.G]=s.create(this.u,{type:"x,y",Z:!0,tt:this,st:2,et:4e3,rt:1e3,it(){return this.nt()},ht(t){return this.ot(t)},ut:{points:s=>t.gt(s)},ct(){return this.lt()},Pt(){return this.dt()},xt(){return this.St()}})}nt(){this.L=!0}ot(){}gt(){}lt(){this.L=!1}dt(){}St(){}};export const SnapsToCircle=s=>class extends(IsDraggable(s)){get ut(){if(this.yt)return null;const t=this;return{get yt(){return t.Dt},get x(){return t.wt?.x},get y(){return t.wt?.y},get _t(){return{x:this.x,y:this.y}}}}get $(){return this.yt.N(this).$}get Tt(){return this.Ct=this.Ct??this.options.Tt??1}set Tt(t){this.Ct=t}get Ot(){return this.ft=this.ft??0}set Ot(t){this.ft=t}async It(s,e=.5){if(!this.yt)return Promise.reject();this.Ot=s;const{$:r}=this;return new Promise(((s,r)=>{t.to(this.u,{Mt:{path:this.yt.path.u,bt:[.5,.5],$t:!1,start:this.$,end:this.Ot},duration:e,tt:this,Nt:"power4.inOut",Ut(){this.V=!0},At(){},Et(){this.V=!1,s()},Ht:r})}))}nt(...t){delete this.wt,delete this.Dt,delete this.kt,super.nt(...t),this.yt&&(this.kt=this.yt,this.yt.vt(this)),this.parent=h.W,this.Rt()}ot(t,...s){super.ot(t,...s)}gt(t){if(!this.wt){super.gt(t);const{x:s,y:e,yt:r}=h.Wt(t,this.kt);this.wt={x:s,y:e},this.Dt=r}return this.wt}lt(){super.lt(),this.Dt.jt(this)}St(){super.St(),this.yt=this.Dt,this.yt.zt(this)}};