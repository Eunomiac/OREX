import{gsap as t,Dragger as s,InertiaPlugin as r,MotionPathPlugin as e,U as i,XElem as n,XCircle as h,XItem as o,XDie as a,XSnap as p}from"./bundler.mjs";class u{constructor(t){this.t=t}i(...t){return t.reduce(((t,s=(t=>t))=>s(t)),this.t)}}export const MIX=(t=class{})=>new u(t);export const HasMotionPath=s=>class extends s{get path(){return this.h}set path(s){const r=t.o(s,"r");t.set(s,{p:-50,u:-50,transformOrigin:"50% 50%"}),$(s).attr("id",`${this.id}-motion-path`),[s]=e.g(s),this.h={id:`${this.id}-motion-path`,l:s,raw:e.P(s),m:r},e.S(this.path.raw)}constructor(s,{D:r={},...e}={}){super(s,e);const[n]=this._.find(".motion-path");t.set(n,i.T({...this.constructor.M.C,...r},(t=>null!==t))),this.path=n}I(t){const{x:s,y:r,angle:i}=e.O(this.path.raw,t,!0);return{x:s,y:r,angle:i,N:t}}U({N:s,x:r,y:e}={}){return s=s??t.k.normalize(-180,180,this.A({x:r,y:e})),this.I(s)}};export const HasSnapPath=s=>class extends(HasMotionPath(s)){get path(){const s=this;return{...super.path,get points(){return[...Array(s.H)].map(((r,e)=>{const i=s.I(t.k.$(0,s.H,0,1,e));return s.v(n.W,i)}))}}}set path(t){super.path=t,this.constructor.j=this}static get j(){return this.R=this.R??new Map}static set j(t){t.path.points.forEach((({x:s,y:r})=>{s=i.X(s),r=i.X(r),this.j.set({x:s,y:r},t)}))}static q(t){this.j.forEach(((s,r,e)=>{t.id===s.id&&e.delete(r)})),super.q(t)}get H(){return this.B=this.B??10}set H(t){this.B=t}};export const IsDraggable=t=>class extends t{get F(){return this.G}get J(){return this.F?.J}get K(){return this.L&&!this.J}get V(){return super.V||this.K||this.J}set V(t){super.V=t}get parent(){return super.parent}set parent(t){super.parent=t,this.F?.update()}constructor(t,s={}){super(t,s),this.Y()}Y(){const t=this;[this.G]=s.create(this.l,{type:"x,y",Z:!0,tt:this,st:2,rt:100,et(){return this.it()},nt(t){return this.ht(t)},ot:{points:s=>t.ut(s)},ct(){return this.gt()},lt(){return this.Pt()},xt(){return this.yt()}})}it(){this.L=!0}ht(){}ut(){}gt(){this.L=!1}Pt(){}yt(){}};export const SnapsToCircle=s=>class extends(IsDraggable(s)){get ot(){if(this.dt)return null;const t=this;return{get dt(){return t.St},get x(){return t.Dt?.x},get y(){return t.Dt?.y},get _t(){return{x:this.x,y:this.y}}}}get N(){return this.dt.U({x:this.x,y:this.y}).N}get wt(){return this.Tt=this.Tt??this.options.wt??1}set wt(t){this.Tt=t}get ft(){return this.Ct=this.Ct??0}set ft(t){this.Ct=t}async Mt(s,r=.5){if(!this.dt)return Promise.reject();if(s===this.ft)return Promise.resolve();this.ft=s;const{N:e}=this;for(;this.ft<e;)this.ft++;for(;Math.abs(e-this.ft)>.5;)this.ft--;return new Promise(((s,e)=>{t.to(this.l,{bt:{path:this.dt.path.l,It:[.5,.5],Ot:!1,start:this.N,end:this.ft},duration:r,tt:this,Nt:"power4.out",Ut(){this.V=!0},kt(){},At(){this.V=!1,s()},Et:e})}))}it(...t){super.it(...t),this.dt?.removeItem(this),this.dt?.Ht(),this.parent=h.W,this.$t()}ht(t,...s){super.ht(t,...s)}ut(t){super.ut(t);const{x:s,y:r,dt:e}=h.vt(t);return{x:s,y:r}}gt(){super.gt(),this.Dt={x:this.Wt,y:this.jt};const{dt:t}=h.vt(this.Dt);this.St=t,this.St.Rt(this)}yt(){super.yt(),this.dt=this.St,this.dt.Xt(!0),t.qt(this.l,this.Dt,{x:this.St.x,y:this.St.y,opacity:.4,Nt:"expo.out",duration:1,tt:this,At(){t.to(this.l,{opacity:1,duration:.5}),this.St.Bt(this).zt(),this.St.Ht(),this.St.Xt(!0)}})}};