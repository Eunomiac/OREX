import{C as t,U as e,DB as s,XItem as r,XDie as i,XMod as a,Dir as n}from"../helpers/bundler.js";export default class o extends r{static t=new Map;static get i(){return e.o(super.i,{h:["x-group"]})}get u(){return super.u}set u(t){super.u=t}get l(){return Array.from(this.p)}constructor(t,e){super(t,e)}}class h extends r{static t=new Map;static get i(){return e.o(super.i,{h:["x-arm"],g:{set:{height:0,width:0,transformOrigin:"0% 50%",top:"50%",left:"50%",m:0,R:0}}})}O;constructor(t,e){super(e,{id:"arm"}),this.O=t,this.I(t,!1)}async initialize(){return await super.initialize()?(this.O.set({left:"unset",top:"unset",right:-1*this.O.width}),this.I(this.O,!1),this.O.X()):Promise.resolve(!1)}}export var XOrbitType;!function(t){t.P="Main",t.T="Inner",t.M="Outer"}(XOrbitType||(XOrbitType={}));export class XOrbit extends o{static t=new Map;static get i(){return e.o(super.i,{h:["x-orbit"]})}#t;#e;#s;get S(){return $(`#${this.id} .x-arm`)}get A(){return Array.from(this.p)}get l(){return this.A.map((t=>t.O))}get $(){return this.l.filter((t=>t instanceof i||t instanceof a))}#r;get G(){return this.#r}set G(t){this.#r=t,this.Y&&this.j()}get k(){return.5*this.G*this.u.width}constructor(e,s,r,i){r??=t.N[e].G,i??=t.N[e].U,super(s,{id:e,g:{set:{height:s.height,width:s.width,left:.5*s.width,top:.5*s.height},V:[t=>t.v()]}}),this.#r=r,this.#t=Math.abs(i),this.#e=i>0?"+=360":"-=360",this.#s=10*this.#r*this.#t}v(t=n.D,e=10){this.Y&&this.to({id:"rotationTween",rotation:(t===n.D?"+":"-")+"=360",duration:e,repeat:-1,W:"none",q:this,B(){this.l.forEach((t=>{t.u?.C&&t.set({rotation:-1*t.u.global.rotation})}))}})}F;j(t=3,e){this.F&&clearTimeout(this.F),this.F=setTimeout((()=>{s.log("Update Arms RUNNING!");const r=360/this.A.length;gsap.timeline().to(this.S,{width:e??this.k,W:"back.out(4)",duration:t,H:{J:1,from:"end"}},"<").to(this.S,{rotation:t=>r*t,W:"power2.out",duration:t},"<")}),10)}async K(t){const e=new h(t,this);return await e.initialize()?(this.j(),Promise.resolve(!0)):Promise.resolve(!1)}async L(t){const e=t.map((t=>{const e=new h(t,this);return this.I(e),console.log(this.A),e.initialize()}));return await Promise.allSettled(e)?(this.j(),Promise.resolve(!0)):Promise.resolve(!1)}}export class XPool extends o{static t=new Map;static get i(){return e.o(super.i,{h:["x-pool"],g:{set:{height:200,width:200}}})}#i=[];#a=new Map;#n=new Map;#o=new Map;get Z(){return this.#a}get _(){return Array.from(this.Z.values())}get l(){return this._.map((t=>t.l)).flat()}constructor(s,{Z:r=e.tt(t.N),...i}){super(s,i);for(const[t,{G:e,U:s}]of Object.entries(r))this.#n.set(t,e),this.#o.set(t,s),this.#a.set(t,new XOrbit(t,this,e,s))}async K(t,e){const s=this.Z.get(e);return s instanceof XOrbit&&await s.initialize()?s.K(t):Promise.resolve(!1)}async L(t){const e=this;return Promise.allSettled(Object.entries(t).map((([t,s])=>s.map((s=>e.K(s,t))))))}}export class XRoll extends XPool{static t=new Map;#h=!1;get et(){return this.#h}get st(){return this.et?this.rt(i,!0).map((t=>t.value)):[]}get it(){return $(`#${this.id} .x-die`)}get nt(){return $(`#${this.id} .x-die .die-val`)}constructor(t,e){super(t,e)}ot(t=!1,e=!0){if(t||!this.#h){this.#h=!0;const t=this.rt(i,!0);e?gsap.timeline({H:.1}).to(this.nt,{color:"transparent",ht:0,duration:.15,W:"power2.out"}).call((()=>t.forEach((t=>t.ut())))).to(this.nt,{color:"black",ht:1}):t.forEach((t=>t.ut()))}}ct(t){return this.Z.get(t)?.$.map((t=>t.value??0))??[]}get lt(){return this.ct(XOrbitType.P)}get dt(){const t=this.lt.sort(),e=t.filter((e=>t.filter((t=>t===e)).length>1)),s=[];for(;e.length;){const t=e.pop(),r=s.findIndex((([e])=>e===t));r>=0?s[r].push(t):s.push([t])}return s}}export class XSource extends XPool{constructor(t,e){super(t,e)}}