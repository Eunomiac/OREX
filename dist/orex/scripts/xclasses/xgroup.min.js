import{C as t,U as e,DB as s,XItem as r,XDie as i,XMod as a,Dir as n}from"../helpers/bundler.js";export default class o extends r{static t=new Map;static get i(){return e.o(super.i,{h:["x-group"]})}get u(){return super.u}set u(t){super.u=t}get l(){return Array.from(this.p)}constructor(t,e){super(t,e)}}class h extends r{static t=new Map;static get i(){return e.o(super.i,{h:["x-arm"],g:{set:{height:0,width:0,transformOrigin:"0% 50%",top:"50%",left:"50%",m:0,R:0}}})}O;constructor(t,e){super(e,{id:"arm"}),this.O=t,this.I(t,!1)}async initialize(){return await super.initialize()?(this.O.set({left:"unset",top:"unset",right:-1*this.O.width}),this.I(this.O,!1),this.O.P()):Promise.resolve(!1)}get X(){return this.O.size}}export var XOrbitType;!function(t){t.T="Main",t.A="Inner",t.M="Outer"}(XOrbitType||(XOrbitType={}));export class XOrbit extends o{static t=new Map;static get i(){return e.o(super.i,{h:["x-orbit"]})}#t;#e;#s;get S(){return $(`#${this.id} > .x-arm`)}get $(){return Array.from(this.p)}get l(){return this.$.map((t=>t.O))}get G(){return this.l.filter((t=>t instanceof i||t instanceof a))}#r;get Y(){return this.#r}set Y(t){this.#r=t,this.j&&this.k()}get N(){return.5*this.Y*this.u.width}get U(){return this.$.map((t=>t.X)).reduce(((t,e)=>t+e),0)}get V(){const t=360/this.U,e=[];let s=0;return this.$.forEach((r=>{s+=r.X,e.push((s-.5*r.X)*t)})),e}constructor(e,s,r,i){r??=t.W[e].Y,i??=t.W[e].v,super(s,{id:e,g:{set:{height:s.height,width:s.width,left:.5*s.width,top:.5*s.height},D:[t=>t.q()]}}),this.#r=r,this.#t=Math.abs(i),this.#e=i>0?"+=360":"-=360",this.#s=10*this.#r*this.#t}q(t=n.B,e=10){this.j&&this.to({id:"rotationTween",rotation:(t===n.B?"+":"-")+"=360",duration:e,repeat:-1,C:"none",F:this,H(){this.G.forEach((t=>{t.J&&t.u?.J&&t.set({rotation:-1*t.u.global.rotation})}))}})}K;k(t=3,e){this.K&&clearTimeout(this.K),this.K=setTimeout((()=>{s.log("Update Arms RUNNING!");const r=this;gsap.timeline().to(this.S,{width:e??this.N,C:"back.out(4)",duration:t,L:{Z:1,from:"end"}},"<").to(this.S,{rotation:t=>r.V[t],C:"power2.out",duration:t},"<")}),10)}async _(t){const e=new h(t,this);return await e.initialize()?(this.k(),Promise.resolve(!0)):Promise.resolve(!1)}async tt(t){const e=t.map((t=>{const e=new h(t,this);return this.I(e),console.log(this.$),e.initialize()}));return await Promise.allSettled(e)?(this.k(),Promise.resolve(!0)):Promise.resolve(!1)}}export class XPool extends o{static t=new Map;static get i(){return e.o(super.i,{h:["x-pool"],g:{set:{height:200,width:200}}})}#i=[];#a=new Map;#n=new Map;#o=new Map;get et(){return this.#a}get st(){return Array.from(this.et.values())}get l(){return this.st.map((t=>t.l)).flat()}constructor(s,{et:r=e.rt(t.W),...i}){super(s,i);for(const[t,{Y:e,v:s}]of Object.entries(r))this.#n.set(t,e),this.#o.set(t,s),this.#a.set(t,new XOrbit(t,this,e,s))}async _(t,e){const s=this.et.get(e);return s instanceof XOrbit&&await s.initialize()?s._(t):Promise.resolve(!1)}async tt(t){const e=this;return Promise.allSettled(Object.entries(t).map((async([t,s])=>await Promise.allSettled(s.map((async s=>await e._(s,t)))))))}}export class XRoll extends XPool{static t=new Map;#h=!1;get it(){return this.#h}get nt(){return this.it?this.ot(i,!0).map((t=>t.value)):[]}get ht(){return $(`#${this.id} .x-die`)}get ut(){return $(`#${this.id} .x-die .die-val`)}constructor(t,e){super(t,e)}ct(t=!1,e=!0){if(t||!this.#h){this.#h=!0;const t=this.ot(i,!0);e?gsap.timeline({L:.1}).to(this.ut,{color:"transparent",lt:0,duration:.15,C:"power2.out"}).call((()=>t.forEach((t=>t.dt())))).to(this.ut,{color:"black",lt:1}):t.forEach((t=>t.dt()))}}gt(t){return this.et.get(t)?.G.map((t=>t.value??0))??[]}get xt(){return this.gt(XOrbitType.T)}get wt(){const t=this.xt.sort(),e=t.filter((e=>t.filter((t=>t===e)).length>1)),s=[];for(;e.length;){const t=e.pop(),r=s.findIndex((([e])=>e===t));r>=0?s[r].push(t):s.push([t])}return s}}export class XSource extends XPool{constructor(t,e){super(t,e)}}