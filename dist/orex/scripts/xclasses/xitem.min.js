import{gsap as t,U as e,DB as i,XElem as s,XGroup as r}from"../helpers/bundler.js";export default class n extends Application{static get t(){return e.i(super.t,{h:!1,o:["x-item"],u:e.g("xitem"),l:n.p,m:{set:{x:0,y:0,rotation:0,scale:1,P:-50,O:-50,transformOrigin:"50% 50%"}}})}static#t;static get p(){return n.#t}static async R(){return n.p&&n.p.A(),n.#t=new n(null,{id:"XROOT",m:{set:{P:0,O:0}}}),n.#t.initialize()}static T=new Map;static X(t){this.T.set(t.id,t)}static k(t){this.T.delete("string"==typeof t?t:t.id)}static D(){return Array.from(this.T.values())}static K(t){return!!this.T.has(t.id)&&this.T.get(t.id)}static#e=Date.now();static#i={x:0,y:0};static $(t,e){Date.now()-this.#e>1e3&&(this.#e=Date.now(),this.#i={x:t,y:e}),this.D().filter((t=>t instanceof r&&t.l===n.p)).forEach((t=>{}))}#s=!1;#r;#n=new Set;G=!1;I;M;get j(){return this.M.j}get S(){return this.M.S}get l(){return this.#r}set l(t){this.#r=t??n.p}get v(){return this.#n}get F(){return this.v.size>0}U(t){t.l=this,this.v.add(t)}C(t){this.v.delete(t)}H(t,i=!1){const s=Array.from(this.v.values()).flat().filter(e.L(t));return i&&s.push(...Array.from(this.v.values()).map((e=>e.H(t,!0))).flat()),s}constructor(t,{o:i=[],...r}){t&&(r.id=e.Y(`${t.id}-${r.id}`.replace(/^X?ROOT-?/,"X-"))),super(r),this.options.o.push(...i),this.I=Object.assign(r,this.options),this.#r=null===t?null:t??n.p,this.M=new s(this,{m:this.I.m}),this.constructor.X(this)}async initialize(){return this._?Promise.resolve(!0):await this.M.q(!0)?Promise.allSettled(this.H(n).map((t=>t.initialize()))).then((()=>(this.#s=!0,Promise.resolve(!0))),(()=>Promise.resolve(!1))):Promise.resolve(!1)}get B(){return this.J}get _(){return this.#s}get x(){return this.M.x}get y(){return this.M.y}get N(){return this.M.N}get rotation(){return this.M.rotation}get scale(){return this.M.scale}get global(){return this.M.global}get height(){return this.M.height}get width(){return this.M.width}get size(){return this.M.size}get V(){return this.M.V}get W(){return this.M.W.bind(this.M)}get Z(){return this.M.Z.bind(this.M)}get q(){return this.M.q.bind(this.M)}get tt(){return this.M.tt.bind(this.M)}et=new Set;it(e){this.et.add(e),t.st.add(e)}rt(e){this.et.delete(e),t.st.remove(e)}get set(){return this.M.set.bind(this.M)}get to(){return this.M.to.bind(this.M)}get from(){return this.M.from.bind(this.M)}get nt(){return this.M.nt.bind(this.M)}A(){this.F&&this.H(n).forEach((t=>t.A())),this.et.forEach((e=>t.st.remove(e))),this.et.clear(),this.l instanceof n&&this.l.C(this),this.B&&(t.ht(this.j),this.S.remove())}getData(){const t=super.getData();return Object.assign(t,{id:this.id,o:this.options.o.join(" ")}),t}async ot(){if(!this.M.ut)return i.error("Attempt to render an unready Application"),Promise.resolve(!1);try{return await this.ct(!0,{}),Promise.resolve(!0)}catch(t){return this.gt=Application.RENDER_STATES.ERROR,Hooks.onError("Application#render",t,{lt:`An error occurred while rendering ${this.constructor.name} ${this.dt}`,log:"error"}),Promise.resolve(!1)}}}