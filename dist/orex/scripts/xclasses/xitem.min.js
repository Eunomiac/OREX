import{gsap as t,U as e,DB as i,XElem as r}from"../helpers/bundler.js";export default class s extends Application{static get t(){return e.i(super.t,{h:!1,o:["x-item"],u:e.g("xitem"),l:s.p,m:{set:{x:0,y:0,rotation:0,scale:1,O:-50,P:-50,transformOrigin:"50% 50%"}}})}static#t;static get p(){return s.#t}static async R(){return s.p&&s.p.A(),s.#t=new s(null,{id:"XROOT",m:{set:{O:0,P:0}}}),s.#t.initialize()}static T=new Map;static X(t){t.constructor.T.set(t.id,t)}static k(t){t.constructor.T.delete("string"==typeof t?t:t.id)}static K(){return Array.from(this.T.values())}#e=!1;#i;#r=new Set;$;I;get j(){return this.I.j}get S(){return this.I.S}get l(){return this.#i}set l(t){this.#i=t??s.p}get G(){return this.#r}get v(){return this.G.size>0}C(t){t.l=this,this.G.add(t)}D(t){this.G.delete(t)}H(t,i=!1){const r=Array.from(this.G.values()).flat().filter(e.M(t));return i&&r.push(...Array.from(this.G.values()).map((e=>e.H(t,!0))).flat()),r}constructor(t,{o:i=[],...n}){t&&(n.id=e.U(`${t.id}-${n.id}`.replace(/^X?ROOT-?/,"X-"))),super(n),this.options.o.push(...i),this.$=Object.assign(n,this.options),this.#i=null===t?null:t??s.p,this.I=new r(this,{m:this.$.m}),this.constructor.X(this)}async initialize(){return this.Y?Promise.resolve(!0):await this.I._(!0)?Promise.allSettled(this.H(s).map((t=>t.initialize()))).then((()=>(this.#e=!0,Promise.resolve(!0))),(()=>Promise.resolve(!1))):Promise.resolve(!1)}get q(){return this.B}get Y(){return this.#e}get x(){return this.I.x}get y(){return this.I.y}get F(){return this.I.F}get rotation(){return this.I.rotation}get scale(){return this.I.scale}get global(){return this.I.global}get height(){return this.I.height}get width(){return this.I.width}get size(){return this.I.size}get J(){return this.I.J}get _(){return this.I._.bind(this.I)}get L(){return this.I.L.bind(this.I)}N=new Set;V(e){this.N.add(e),t.W.add(e)}Z(e){this.N.delete(e),t.W.remove(e)}get set(){return this.I.set.bind(this.I)}get to(){return this.I.to.bind(this.I)}get from(){return this.I.from.bind(this.I)}get tt(){return this.I.tt.bind(this.I)}A(){this.v&&this.H(s).forEach((t=>t.A())),this.N.forEach((e=>t.W.remove(e))),this.N.clear(),this.l instanceof s&&this.l.D(this),this.q&&(t.et(this.j),this.S.remove())}getData(){const t=super.getData();return Object.assign(t,{id:this.id,o:this.options.o.join(" ")}),t}async it(){if(!this.I.rt)return i.error("Attempt to render an unready Application"),Promise.resolve(!1);try{return await this.st(!0,{}),Promise.resolve(!0)}catch(t){return this.nt=Application.RENDER_STATES.ERROR,Hooks.onError("Application#render",t,{ht:`An error occurred while rendering ${this.constructor.name} ${this.ot}`,log:"error"}),Promise.resolve(!1)}}}